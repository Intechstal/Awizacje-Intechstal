<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <title>Panel Admina - Awizacje</title>
    <style>
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #aaa; padding: 6px; text-align: center; }
        .slot {
            padding: 4px 8px;
            border-radius: 4px;
            margin: 1px;
            display: inline-block;
            min-width: 120px;
        }
        .accepted { background-color: #b2fab4; }  /* jasna zieleń */
        .pending { background-color: #fab4b4; }   /* jasna czerwień */
        .free { background-color: #eee; }
        a.button {
            padding: 4px 8px;
            background: #444;
            color: white;
            text-decoration: none;
            border-radius: 3px;
            margin: 0 3px;
        }
        a.button:hover { background: #666; }
    </style>
</head>
<body>
    <h1>Panel Admina - Awizacje</h1>

    <h2>Lista awizacji</h2>
    <table>
        <thead>
            <tr>
                <th>Firma</th>
                <th>Rejestracja</th>
                <th>Kierowca</th>
                <th>Data i godzina</th>
                <th>Status</th>
                <th>Akcje</th>
            </tr>
        </thead>
        <tbody>
            {% for a in awizacje %}
            <tr>
                <td>{{ a[1] }}</td>
                <td>{{ a[2] }}</td>
                <td>{{ a[3] }}</td>
                <td>{{ a[6].replace('T', ' ') }}</td>
                <td>{{ a[10] }}</td>
                <td>
                    <a class="button" href="/admin/accept/{{ a[0] }}">Zaakceptuj</a>
                    <a class="button" href="/admin/reject/{{ a[0] }}" onclick="return confirm('Na pewno usunąć?')">Usuń</a>
                    <a class="button" href="/admin/edit/{{ a[0] }}">Edytuj</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>Kalendarz awizacji (zablokowane sloty)</h2>
    <table>
        <thead>
            <tr>
                <th>Data/Godzina</th>
                {% for dzien in dni %}
                    <th>{{ dzien.strftime('%Y-%m-%d (%a)') }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for godzina in godziny %}
            <tr>
                <td>{{ godzina.strftime('%H:%M') }}</td>
                {% for dzien in dni %}
                    {% set slot_key = dzien.strftime('%Y-%m-%d') + 'T' + godzina.strftime('%H:%M') %}
                    {% if slot_key in zajete %}
                        {% set entry = zajete[slot_key] %}
                        {% if entry.status == 'zaakceptowana' %}
                            <td class="slot accepted">{{ entry.firma }}</td>
                        {% else %}
                            <td class="slot pending">{{ entry.firma }}</td>
                        {% endif %}
                    {% else %}
                        <td class="slot free"></td>
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>
